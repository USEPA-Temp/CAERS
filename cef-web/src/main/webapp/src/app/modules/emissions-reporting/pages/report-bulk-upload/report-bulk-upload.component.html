<div class="card">
    <div class="card-header">
        <div class="font-weight-bold text-center">Upload Report</div>
    </div>
    <div class="card-body">

        <p>
            Search for a Combined Air Emissions Reporting System upload file that
            you would like to use for the
            {{reportingYear}} Emissions Report for {{facility.facilityName | stripPeriodEnding}}.
            Please be aware that uploading a new report will remove any existing inventory data
            for this reporting year and replace it with the file contents.
        </p>

        <div class="form-group">
            <label for="file-excel-workbook" class="font-weight-bold" title="Excel Workbook is required.">
                <span>Excel Workbook</span>
                <span style="color: red">*</span>
            </label>
            <div class="custom-file">
                <input id="file-excel-workbook" type="file"
                       class="custom-file-input" (change)="onFileChanged($event.target.files)">
                <label for="file-excel-workbook" class="custom-file-label">Click to browse...</label>
            </div>
        </div>

        <div *ngIf="uploadFailed">
            <div class="alert alert-danger" role="alert">
                <div class="h4 alert-heading">Workbook Upload Error</div>
                <p>Below is a list of data error(s) found after parsing the workbook "{{selectedFile.name}}".</p>
                <p class="mb-0">Please correct all data errors in the workbook and try again.</p>
            </div>
            <div class="validation-item-error">
                <div class="h5 font-weight-bolder">Data Error(s)</div>
                <ol>
                    <li *ngFor="let error of uploadErrors">
                        <span class="font-weight-bold mr-1">Sheet:</span>
                        <span [textContent]="error.worksheet"></span>
                        <span class="font-weight-bold ml-2 mr-1">Row:</span>
                        <span [textContent]="error.row"></span>
                        <span class="font-weight-bold ml-2 mr-1">Message:</span>
                        <span [textContent]="error.message"></span>
                    </li>
                </ol>
            </div>

        </div>

    </div>
    <div class="card-footer">
        <div class="d-flex flex-row justify-content-end">
            <a href="javascript:void(0);"
               class="btn btn-primary mr-2"
               [routerLink]="['/facility', facility.programId, 'report']">
                <span>Cancel</span>
            </a>
            <button type="button" class="btn btn-success"
                    [ngClass]="{'disable-click' : selectedFile === null}"
                    [disabled]="selectedFile === null"
                    (click)="onUploadClick()">
                <span>Upload</span>
            </button>
        </div>
    </div>
</div>

<ng-template #PleaseWaitModal>
    <div class="modal-header bg-info text-white">
        <div class="modal-title h4"><strong>Bulk Upload</strong></div>
    </div>
    <div class="modal-body">
        <div class="mb-2">Please wait this could take a minute or two.</div>
        <div class="mb-2 font-weight-bold">
            <span [textContent]="pleaseWait.message"></span>
            <span class="ml-2" [textContent]="pleaseWait.progress + '%'"></span>
        </div>
        <div class="progress" style="height: 40px;">
            <div class="progress-bar progress-bar-striped progress-bar-animated bg-info"
                 role="progressbar" [style.width]="pleaseWait.progress + '%'"
                 [attr.aria-valuenow]="pleaseWait.progress" aria-valuemin="0" aria-valuemax="100">
            </div>
        </div>
    </div>
</ng-template>
