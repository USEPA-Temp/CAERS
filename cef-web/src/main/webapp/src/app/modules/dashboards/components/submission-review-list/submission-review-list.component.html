<form>

  <div class="mh-100 overflow-auto">
    <table class="table table-sm table-striped table-bordered">
      <thead class="thead-cef-medium">
      <tr>
        <th *ngIf="reportStatus !== 'IN_PROGRESS' && reportStatus !== 'RETURNED'" scope="col">Select</th>
        <th scope="col" sortable="facilityName" (sort)="onSort($event)">Facility Name</th>
        <th scope="col" sortable="altFacilityId" (sort)="onSort($event)">Agency Facility ID</th>
        <th scope="col" sortable="operatingStatus" (sort)="onSort($event)">Operating Status</th>
        <th scope="col" sortable="industry" (sort)="onSort($event)">Industry Sector</th>
        <th scope="col" sortable="year" (sort)="onSort($event)">Submittal Year</th>
        <th scope="col" sortable="lastSubmittalYear" (sort)="onSort($event)">Last Submittal Year</th>
        <th scope="col" style="width:310px;">Actions</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let submission of tableItems">
        <th *ngIf="reportStatus !== 'IN_PROGRESS' && reportStatus !== 'RETURNED'" scope="row"><input type="checkbox" name="report{{submission.emissionsReportId}}" [(ngModel)]="submission.checked"  aria-label="select report"></th>
        <td><ngb-highlight [result]="submission.facilityName"></ngb-highlight></td>
        <td><ngb-highlight [result]="submission.altFacilityId"></ngb-highlight></td>
        <td><ngb-highlight [result]="submission.operatingStatus"></ngb-highlight></td>
        <td><ngb-highlight [result]="submission.industry"></ngb-highlight></td>
        <td><ngb-highlight [result]="submission.year"></ngb-highlight></td>
        <td><ngb-highlight [result]="submission.lastSubmittalYear || 'None submitted previously'"></ngb-highlight></td>
        <td>
          <button class="btn btn-primary btn-sm mr-1" (click)="openSummaryModal(submission)" [attr.aria-label]="'view' + submission?.year + submission?.facilityName + 'summary'">Summary</button>
          <button class="btn btn-primary btn-sm mr-1" 
                [routerLink]="['/facility', submission.masterFacilityId, 'report', submission.emissionsReportId, 'summary']"
                [attr.aria-label]="'view' + submission?.year + submission?.facilityName + 'report'">View Report</button>
          <button class="btn btn-primary btn-sm mt-1" 
                (click)="downloadReport(submission.emissionsReportId, submission.facilitySiteId, submission.year, submission.altFacilityId, submission.reportStatus)"
                [attr.aria-label]="'download' + submission?.year + submission?.facilityName + 'report'">Download Process Emissions Summary</button>
        </td>
      </tr>
      </tbody>
    </table>
    <div *ngIf="tableItems && tableItems.length > 0">
      <ngb-pagination [(page)]="controller.page" [pageSize]="controller.pageSize" [collectionSize]="controller.total$ | async" [maxSize]="5" [rotate]="true"></ngb-pagination>
    </div>
  </div>

</form>
